(this["webpackJsonpreact-simple-peer-video-stream-test"]=this["webpackJsonpreact-simple-peer-video-stream-test"]||[]).push([[0],{40:function(e,t,n){e.exports=n(84)},45:function(e,t,n){},6:function(e,t,n){e.exports={wrapper:"VideoSimplePeer_wrapper__1ju8T",left:"VideoSimplePeer_left__2umav",video:"VideoSimplePeer_video__KtgIS",right:"VideoSimplePeer_right__cd2lS",form:"VideoSimplePeer_form__1qvQv"}},69:function(e,t){},71:function(e,t){},79:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=79},8:function(e,t,n){e.exports={wrapper:"VideoPeerJS_wrapper__37lXB",left:"VideoPeerJS_left__37RIy",video:"VideoPeerJS_video__1pBp_",right:"VideoPeerJS_right__3ltnP",form:"VideoPeerJS_form__1zsv2"}},84:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(35),o=n.n(r),l=(n(45),n(20)),s=n(7),u=n(15),i=n(19),m=n(16),f=n.n(m),p=n(2),d=n(6),g=n.n(d),b=n(36),E=n.n(b),v=function(){var e=Object(a.useRef)(null),t=Object(a.useRef)(null),n=Object(a.useState)(null),r=Object(p.a)(n,2),o=r[0],l=r[1],s=Object(a.useState)(null),m=Object(p.a)(s,2),d=m[0],b=m[1],v=Object(a.useState)(null),O=Object(p.a)(v,2),S=O[0],j=O[1],h=Object(a.useState)("#init"===window.location.hash),y=Object(p.a)(h,1)[0],_=Object(a.useState)(y?"PEER 1":"PEER 2"),w=Object(p.a)(_,1)[0],N=Object(a.useState)({connectData:"",message:""}),P=Object(p.a)(N,2),D=P[0],x=P[1];Object(a.useEffect)((function(){e.current&&d&&(e.current.srcObject=d,e.current.oncanplay=function(){e.current.play(),e.current.muted=!0})}),[d]),Object(a.useEffect)((function(){t.current&&S&&(t.current.srcObject=S,t.current.oncanplay=function(){t.current.play(),t.current.muted=!1})}),[S]),Object(a.useEffect)((function(){console.log("Peer",o),o&&(o.on("error",(function(e){return console.error("error",e)})),o.on("signal",(function(e){"offer"!==e.type&&"answer"!==e.type||(console.log("%c ".concat(JSON.stringify(e)),"background: #222; color: #bada55"),alert("open console and copy the console.log with the black background. Give it to the other peer to connect"))})),o.on("connect",(function(){console.log("CONNECT")})),o.on("data",(function(e){var t=JSON.parse(e);console.log("parsed",t),t.message&&console.log("%c MESSAGE - ".concat(t.message.author,': "').concat(t.message.text,'"'),"background: black; color: white; padding: 1rem")})),o.on("stream",(function(e){j(e)})))}),[o]);var k=function(e){return x(Object(i.a)({},D,Object(u.a)({},e.target.name,e.target.value)))};return c.a.createElement("div",{className:g.a.wrapper},c.a.createElement("div",{className:g.a.left},c.a.createElement("h2",null,"My Stream"),c.a.createElement("video",{ref:e,className:g.a.video}),c.a.createElement("h2",null,"Remote Stream"),c.a.createElement("video",{ref:t,className:g.a.video})),c.a.createElement("div",{className:g.a.right},c.a.createElement("button",{onClick:function(e){return function(){var e;return f.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.a.awrap(navigator.mediaDevices.getUserMedia({video:!0,audio:!0}));case 3:e=t.sent,b(e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error('stream couldnt be started via "startStream()"',t.t0);case 10:case"end":return t.stop()}}),null,null,[[0,7]])}()}},"Start My Stream"),c.a.createElement("button",{onClick:function(e){l(new E.a({initiator:y,trickle:!1,stream:d}))}},"Init This Peer ".concat(y?"(Generates Offer)":"")),c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),o.signal(JSON.parse(D.connectData))},className:[g.a.form,g.a.connectForm].join(" ")},c.a.createElement("fieldset",null,c.a.createElement("legend",null,"Connect"),c.a.createElement("textarea",{name:"connectData",id:"connectData",onChange:k,value:D.connectData,placeholder:"".concat(y?"Enter Answer":"Enter Offer"," of other Peer")}),c.a.createElement("button",{type:"submit"},"connect ",y?"":"(Generates Answer)"))),c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),console.log("sending message"),function(){if(o){var e={author:w,text:D.message};o.send(JSON.stringify({message:e}))}}()},className:[g.a.form,g.a.sendMessageForm].join(" ")},c.a.createElement("fieldset",null,c.a.createElement("legend",null,"Send Message to Peer"),c.a.createElement("input",{type:"text","aria-label":"chat input",name:"message",value:D.message,onChange:k,placeholder:"Hello Peer..."}),c.a.createElement("button",{type:"submit"},"send")))))},O=n(8),S=n.n(O),j=n(37),h=n.n(j),y=function(){var e=Object(a.useRef)(null),t=Object(a.useRef)(null),n=Object(a.useState)(null),r=Object(p.a)(n,2),o=r[0],l=r[1],s=Object(a.useState)(null),m=Object(p.a)(s,2),d=m[0],g=m[1],b=Object(a.useState)(null),E=Object(p.a)(b,2),v=E[0],O=E[1],j=Object(a.useState)(null),y=Object(p.a)(j,2),_=y[0],w=y[1],N=Object(a.useState)(null),P=Object(p.a)(N,2),D=P[0],x=P[1],k=Object(a.useState)({connectData:"",message:""}),C=Object(p.a)(k,2),J=C[0],M=C[1];Object(a.useEffect)((function(){e.current&&_&&(e.current.srcObject=_,e.current.oncanplay=function(){e.current.play(),e.current.muted=!0})}),[_]),Object(a.useEffect)((function(){t.current&&D&&(t.current.srcObject=D,t.current.oncanplay=function(){t.current.play(),t.current.muted=!1})}),[D]),Object(a.useEffect)((function(){o&&(o.on("open",(function(e){console.log("My peer ID is: "+e),console.log("PEERr",o),alert("my peer id: "+e)})),o.on("connection",(function(e){console.log("connection",e),g(e)})),o.on("call",(function(e){console.log("incoming call. Answering automatically"),O(e),e.answer(_)})))}),[o]),Object(a.useEffect)((function(){d&&(console.log("CONNECTION ESTABLISHED"),d.on("open",(function(){d.on("data",(function(e){var t=JSON.parse(e);console.log("parsed",t),t.message&&(console.log("%c MESSAGE - ".concat(t.message.author,': "').concat(t.message.text,'"'),"background: black; color: white; padding: 1rem"),alert("incomming message: "+t.message.text))}))})))}),[d]),Object(a.useEffect)((function(){v&&v.on("stream",(function(e){x(e)}))}),[v]);var R=function(e){return M(Object(i.a)({},J,Object(u.a)({},e.target.name,e.target.value)))};return c.a.createElement("div",{className:S.a.wrapper},c.a.createElement("div",{className:S.a.left},c.a.createElement("h2",null,"My Stream"),c.a.createElement("video",{ref:e,className:S.a.video}),c.a.createElement("h2",null,"Remote Stream"),c.a.createElement("video",{ref:t,className:S.a.video})),c.a.createElement("div",{className:S.a.right},c.a.createElement("button",{onClick:function(e){return function(){var e;return f.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.a.awrap(navigator.mediaDevices.getUserMedia({video:!0,audio:!0}));case 3:e=t.sent,w(e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error('stream couldnt be started via "startStream()"',t.t0);case 10:case"end":return t.stop()}}),null,null,[[0,7]])}()}},"Start My Stream"),c.a.createElement("button",{onClick:function(e){l(new h.a({debug:!0,config:{iceServers:[{url:"stun:stun.l.google.com:19302"}]}}))}},"Init This Peer"),c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),g(o.connect(J.connectData))},className:S.a.form},c.a.createElement("fieldset",null,c.a.createElement("legend",null,"Connect"),c.a.createElement("input",{type:"text",name:"connectData",id:"connectData",onChange:R,value:J.connectData,placeholder:"enter peer id you want to connect with"}),c.a.createElement("button",{type:"submit"},"connect"))),c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),function(){if(o&&d){var e={author:"derp",text:J.message};d.send(JSON.stringify({message:e})),console.log("sending message")}}()},className:S.a.form},c.a.createElement("fieldset",null,c.a.createElement("legend",null,"Send Message to Peer"),c.a.createElement("input",{type:"text","aria-label":"chat input",name:"message",value:J.message,onChange:R,placeholder:"Hello Peer..."}),c.a.createElement("button",{type:"submit"},"send"))),c.a.createElement("button",{onClick:function(e){var t;t=J.connectData,o&&d&&_&&O(o.call(t,_))}},"CALL")))},_=function(){return c.a.createElement(l.a,null,c.a.createElement(l.b,{to:"/simplepeer"},"Simple Peer Test"),c.a.createElement(l.b,{to:"/peerjs"},"Peer JS Test"),c.a.createElement(s.c,null,c.a.createElement(s.a,{path:"/simplepeer",component:v}),c.a.createElement(s.a,{path:"/peerJS",component:y})))};o.a.render(c.a.createElement(_,null),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.fee1c6a4.chunk.js.map