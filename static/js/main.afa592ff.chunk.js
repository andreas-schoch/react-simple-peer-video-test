(this["webpackJsonpreact-simple-peer-video-stream-test"]=this["webpackJsonpreact-simple-peer-video-stream-test"]||[]).push([[0],{1:function(e,t,n){e.exports={wrapper:"VideoCallMockup_wrapper__NT1MO",left:"VideoCallMockup_left__33sis",video:"VideoCallMockup_video__24a2f",right:"VideoCallMockup_right__3SrC3",form:"VideoCallMockup_form__DP3CS"}},24:function(e,t,n){e.exports=n(63)},29:function(e,t,n){},53:function(e,t){},55:function(e,t){},63:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(21),o=n.n(r),l=(n(29),n(9)),s=n(22),u=n(11),i=n.n(u),m=n(2),f=n(1),d=n.n(f),p=n(23),b=n.n(p),g=function(){var e=Object(a.useRef)(null),t=Object(a.useRef)(null),n=Object(a.useState)(null),r=Object(m.a)(n,2),o=r[0],u=r[1],f=Object(a.useState)(null),p=Object(m.a)(f,2),g=p[0],E=p[1],O=Object(a.useState)(null),v=Object(m.a)(O,2),j=v[0],S=v[1],h=Object(a.useState)("#init"===window.location.hash),y=Object(m.a)(h,1)[0],_=Object(a.useState)(y?"PEER 1":"PEER 2"),k=Object(m.a)(_,1)[0],w=Object(a.useState)([]),C=(Object(m.a)(w,1)[0],Object(a.useState)({connectData:"",message:""})),N=Object(m.a)(C,2),M=N[0],x=N[1];Object(a.useEffect)((function(){e.current&&g&&(e.current.srcObject=g,e.current.oncanplay=function(){e.current.play(),e.current.muted=!0})}),[g]),Object(a.useEffect)((function(){t.current&&j&&(t.current.srcObject=j,t.current.oncanplay=function(){t.current.play(),t.current.muted=!1})}),[j]),Object(a.useEffect)((function(){console.log("TESTPEER",o),o&&(o.on("error",(function(e){return console.error("error",e)})),o.on("signal",(function(e){"offer"!==e.type&&"answer"!==e.type||console.log("%c ".concat(JSON.stringify(e)),"background: #222; color: #bada55")})),o.on("connect",(function(){console.log("CONNECT")})),o.on("data",(function(e){var t=JSON.parse(e);console.log("parsed",t),t.message&&console.log("%c MESSAGE - ".concat(t.message.author,': "').concat(t.message.text,'"'),"background: black; color: white; padding: 1rem")})),o.on("stream",(function(e){S(e)})))}),[o]);var D=function(e){return x(Object(s.a)({},M,Object(l.a)({},e.target.name,e.target.value)))};return c.a.createElement("div",{className:d.a.wrapper},c.a.createElement("div",{className:d.a.left},c.a.createElement("h2",null,"My Stream"),c.a.createElement("video",{ref:e,className:d.a.video}),c.a.createElement("h2",null,"Remote Stream"),c.a.createElement("video",{ref:t,className:d.a.video})),c.a.createElement("div",{className:d.a.right},c.a.createElement("button",{onClick:function(e){return function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.a.awrap(navigator.mediaDevices.getUserMedia({video:!0,audio:!0}));case 3:e=t.sent,E(e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error('stream couldnt be started via "startStream()"',t.t0);case 10:case"end":return t.stop()}}),null,null,[[0,7]])}()}},"Start My Stream"),c.a.createElement("button",{onClick:function(e){u(new b.a({initiator:y,trickle:!1,stream:g}))}},"Init This Peer ".concat(y?"(Generates Offer)":"")),c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),o.signal(JSON.parse(M.connectData))},className:[d.a.form,d.a.connectForm].join(" ")},c.a.createElement("fieldset",null,c.a.createElement("legend",null,"Connect"),c.a.createElement("textarea",{name:"connectData",id:"connectData",onChange:D,value:M.connectData,placeholder:"".concat(y?"Enter Answer":"Enter Offer"," of other Peer")}),c.a.createElement("button",{type:"submit"},"connect ",y?"":"(Generates Answer)"))),c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),console.log("sending message"),function(){if(o){var e={author:k,text:M.message};o.send(JSON.stringify({message:e}))}}()},className:[d.a.form,d.a.sendMessageForm].join(" ")},c.a.createElement("fieldset",null,c.a.createElement("legend",null,"Send Message to Peer"),c.a.createElement("input",{type:"text","aria-label":"chat input",name:"message",value:M.message,onChange:D,placeholder:"Hello Peer..."}),c.a.createElement("button",{type:"submit"},"send")))))},E=function(){return c.a.createElement(g,null)};o.a.render(c.a.createElement(E,null),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.afa592ff.chunk.js.map